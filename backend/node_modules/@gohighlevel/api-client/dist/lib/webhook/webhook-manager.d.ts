import { Request, Response, NextFunction } from 'express';
import { Logger } from '../logging';
import { SessionStorage } from '../storage/session-storage';
interface OAuthService {
    getLocationAccessToken(requestBody: {
        companyId: string;
        locationId: string;
    }): Promise<any>;
}
/**
 * WebhookManager handles incoming webhooks from GoHighLevel
 * Provides Express middleware for processing webhook events
 */
export declare class WebhookManager {
    private logger;
    private sessionStorage;
    private oauthService;
    constructor(logger: Logger, sessionStorage: SessionStorage, oauthService: OAuthService);
    /**
     * Returns Express middleware for handling GoHighLevel webhooks
     * For all webhooks, it will validate the webhook signature if received.
     * This middleware will handle INSTALL and UNINSTALL webhooks.
     * It will automatically generate token and store it for INSTALL webhook event
     * It will automatically remove token for UNINSTALL webhook event
     */
    subscribe(): (req: Request, res: Response, next: NextFunction) => Promise<void>;
    /**
     * Verify webhook signature using GoHighLevel's public key
     * @param payload - The JSON stringified request body
     * @param signature - The signature from x-wh-signature header
     * @param publicKey - The public key from environment variable
     * @returns True if signature is valid, false otherwise
     */
    verifySignature(payload: string, signature: string, publicKey: string): boolean;
    /**
     * Generate location access token and store it using company token
     * @param companyId - The company ID
     * @param locationId - The location ID
     */
    private generateLocationAccessToken;
}
export {};
//# sourceMappingURL=webhook-manager.d.ts.map